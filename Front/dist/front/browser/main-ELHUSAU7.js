import{$ as Oe,A as w,B as P,C as B,D as Y,E as se,F as j,G as le,H as de,I as ce,J as pe,K as me,L as ue,M as ge,N as X,O as N,P as fe,Q as _e,R as ve,S as he,T as Se,U as J,V as ye,W as Ce,X as Me,Y as Ee,Z as xe,_ as be,a as G,aa as Te,b as ee,ba as ke,c as te,ca as we,d as ne,da as Pe,e as K,ea as Ne,f as y,fa as F,g as v,ga as W,h as ie,ha as Ie,i as E,j as x,k as oe,l as d,m as h,n as R,o as f,p as _,q as a,r as s,s as re,t as b,u as O,v as u,w as l,x as T,y as ae,z as k}from"./chunk-2KAPHJBX.js";var H="@@STATE",I=(function(e){return e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage",e})(I||{}),U=new y(""),De=new y("",{providedIn:"root",factory:()=>v(U).keys==="*"}),D=new y(""),Q=new y("");function $(e){return!!e?.engine}function Ae(e){return $(e)&&(e=e.key),N(e,X)&&(e=e[X].name),e instanceof fe?e.getName():e}function Ve(e){return ee(G({storage:I.LocalStorage,serialize:JSON.stringify,deserialize:JSON.parse,beforeSerialize:i=>i,afterDeserialize:i=>i},e),{keys:e.keys==="*"?[H]:e.keys})}function ze(e){return e.storage===I.LocalStorage?localStorage:e.storage===I.SessionStorage?sessionStorage:null}function Le(e,i){return i?.namespace?`${i.namespace}:${e}`:e}var Ke=(()=>{class e{_keys=new Set;_injector=v(oe);_keysWithEngines=[];constructor(){let{keys:t}=v(D);this.addKeys(t)}getKeysWithEngines(){return[...this._keysWithEngines]}addKeys(t){for(let o of t){let r=Ae(o);if(this._keys.has(r))continue;this._keys.add(r);let n=$(o)?this._injector.get(o.engine):this._injector.get(Q);this._keysWithEngines.push({key:r,engine:n})}}static \u0275fac=function(o){return new(o||e)};static \u0275prov=K({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Be=(()=>{class e{_keysManager=v(Ke);_options=v(D);_allStatesPersisted=v(De);handle(t,o,r){let n=he(o),M=n(_e),g=n(ve),q=M||g,Z=!1;if(q){let S=g&&o.addedStates;for(let{key:m,engine:V}of this._keysManager.getKeysWithEngines()){if(!this._allStatesPersisted&&S){let p=m.indexOf(Ye),z=p>-1?m.slice(0,p):m;if(!N(S,z))continue}let L=Le(m,this._options),c=V.getItem(L);if(c!=="undefined"&&c!=null){try{let p=this._options.deserialize(c);c=this._options.afterDeserialize(p,m)}catch{c={}}this._options.migrations?.forEach(p=>{let z=p.version===J(c,p.versionKey||"version"),Ue=!p.key&&this._allStatesPersisted||p.key===m;z&&Ue&&(c=p.migrate(c),Z=!0)}),this._allStatesPersisted?(c=this._hydrateSelectivelyOnUpdate(c,S),t=G(G({},t),c)):t=Se(t,m,c)}}}return r(t,o).pipe(ne(S=>{if(!(q&&!Z))for(let{key:m,engine:V}of this._keysManager.getKeysWithEngines()){let L=S,c=Le(m,this._options);m!==H&&(L=J(S,m));try{let p=this._options.beforeSerialize(L,m);V.setItem(c,this._options.serialize(p))}catch{}}}))}_hydrateSelectivelyOnUpdate(t,o){return!t||!o||Object.keys(o).length===0?t:Object.keys(o).reduce((r,n)=>(N(t,n)&&(r[n]=t[n]),r),{})}static \u0275fac=function(o){return new(o||e)};static \u0275prov=K({token:e,factory:e.\u0275fac})}return e})(),Ye=".";function Re(e){return ie([Ee(Be),{provide:U,useValue:e},{provide:D,useFactory:Ve,deps:[U]},{provide:Q,useFactory:ze,deps:[D]}])}function Je(e,i){e&1&&(a(0,"h2"),l(1,"Connexion"),s())}function He(e,i){e&1&&(a(0,"h2"),l(1,"Cr\xE9er un compte"),s())}function Qe(e,i){if(e&1){let t=b();a(0,"div",2)(1,"label"),l(2,"Firstname"),s(),a(3,"input",8),P("ngModelChange",function(r){E(t);let n=u();return w(n.firstname,r)||(n.firstname=r),x(r)}),s()()}if(e&2){let t=u();d(3),k("ngModel",t.firstname)}}function $e(e,i){if(e&1){let t=b();a(0,"div",2)(1,"label"),l(2,"Lastname"),s(),a(3,"input",9),P("ngModelChange",function(r){E(t);let n=u();return w(n.lastname,r)||(n.lastname=r),x(r)}),s()()}if(e&2){let t=u();d(3),k("ngModel",t.lastname)}}function qe(e,i){if(e&1&&(a(0,"div",5),l(1),s()),e&2){let t=u();d(),T(t.error)}}var je=(()=>{let i=class i{constructor(o,r,n){this.auth=o,this.router=r,this.usersService=n,this.firstname="",this.lastname="",this.login="",this.password="",this.error="",this.signupMode=!1}submit(){if(!this.signupMode)this.auth.login(this.login,this.password).subscribe(o=>{o?this.router.navigate(["/pollution/list"]):this.error="Identifiants invalides"});else{let o={login:this.login,password:this.password,firstname:this.firstname,lastname:this.lastname};this.auth.signup(o).subscribe(r=>{r?this.router.navigate(["/pollution/list"]):this.error="Impossible de cr\xE9er le compte (login peut exister)"})}}toggleSignup(){this.signupMode=!this.signupMode,this.error=""}};i.\u0275fac=function(r){return new(r||i)(h(F),h(pe),h(Ne))},i.\u0275cmp=R({type:i,selectors:[["app-login"]],decls:19,vars:8,consts:[[1,"login-container"],[3,"ngSubmit"],[1,"form-group"],["name","login",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","password",1,"form-control",3,"ngModelChange","ngModel"],[1,"error"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-link",3,"click"],["name","firstname",1,"form-control",3,"ngModelChange","ngModel"],["name","lastname",1,"form-control",3,"ngModelChange","ngModel"]],template:function(r,n){r&1&&(a(0,"div",0),f(1,Je,2,0,"h2"),f(2,He,2,0,"h2"),a(3,"form",1),O("ngSubmit",function(){return n.submit()}),f(4,Qe,4,1,"div",2),f(5,$e,4,1,"div",2),a(6,"div",2)(7,"label"),l(8,"Login"),s(),a(9,"input",3),P("ngModelChange",function(g){return w(n.login,g)||(n.login=g),g}),s()(),a(10,"div",2)(11,"label"),l(12,"Mot de passe"),s(),a(13,"input",4),P("ngModelChange",function(g){return w(n.password,g)||(n.password=g),g}),s()(),f(14,qe,2,1,"div",5),a(15,"button",6),l(16),s(),a(17,"button",7),O("click",function(){return n.toggleSignup()}),l(18," {{ signupMode ? 'J'ai d\xE9j\xE0 un compte' : 'Cr\xE9er un compte' }} "),s()()()),r&2&&(d(),_(n.signupMode?-1:1),d(),_(n.signupMode?2:-1),d(2),_(n.signupMode?4:-1),d(),_(n.signupMode?5:-1),d(4),k("ngModel",n.login),d(4),k("ngModel",n.password),d(),_(n.error?14:-1),d(2),ae(" ",n.signupMode?"Cr\xE9er le compte":"Se connecter"," "))},dependencies:[j,Pe,we,xe,be,Oe,ke,Te],styles:[".login-container[_ngcontent-%COMP%]{max-width:420px;margin:24px auto;padding:16px;background:#fff;border-radius:8px;box-shadow:0 2px 8px #00000014}.form-group[_ngcontent-%COMP%]{margin-bottom:12px}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px}.error[_ngcontent-%COMP%]{color:#b00020;margin-bottom:8px}"]});let e=i;return e})();var Fe=[{path:"login",component:je},{path:"",redirectTo:"/pollution/list",pathMatch:"full"},{path:"pollution",loadChildren:()=>import("./chunk-7WWKT5NV.js").then(e=>e.PollutionModule)},{path:"**",redirectTo:"/pollution/list"}];var We={providers:[ge(Fe),de(),Me([W],Re({keys:["favorites"]}))]};function Ze(e,i){if(e&1&&(a(0,"span",11),l(1),B(2,"async"),s()),e&2){let t=u(2);d(),T(Y(2,1,t.favoritesCount$))}}function et(e,i){if(e&1&&(a(0,"a",6),l(1," \u{1F499} Favoris "),f(2,Ze,3,3,"span",11),B(3,"async"),s()),e&2){let t=u();d(2),_(Y(3,1,t.favoritesCount$)>0?2:-1)}}function tt(e,i){if(e&1){let t=b();a(0,"div",8)(1,"span"),l(2),s(),a(3,"button",12),O("click",function(){E(t);let r=u();return x(r.logout())}),l(4,"Se d\xE9connecter"),s()()}if(e&2){let t=u();d(2),T(t.userName)}}var C=class C{constructor(i,t){this.auth=i,this.store=t,this.title="Pollution Tracker",this.userName=""}ngOnInit(){this.auth.getCurrentUser().subscribe(i=>{this.userName=i?`${i.firstname} ${i.lastname}`:""})}logout(){this.auth.logout()}};C.\u0275fac=function(t){return new(t||C)(h(F),h(ye))},C.\u0275cmp=R({type:C,selectors:[["app-root"]],decls:19,vars:2,consts:[[1,"app-container"],[1,"navbar"],[1,"navbar-brand"],[1,"navbar-menu"],["routerLink","/pollution/list","routerLinkActive","active",1,"nav-link"],["routerLink","/pollution/report","routerLinkActive","active",1,"nav-link"],["routerLink","/pollution/favorites","routerLinkActive","active",1,"nav-link","favorites-link"],["routerLink","/login","routerLinkActive","active",1,"nav-link"],[1,"nav-user"],[1,"main-content"],[1,"footer"],[1,"badge"],[1,"btn","btn-link",3,"click"]],template:function(t,o){t&1&&(a(0,"div",0)(1,"nav",1)(2,"div",2)(3,"h1"),l(4,"\u{1F30D} Pollution Tracker"),s()(),a(5,"div",3)(6,"a",4),l(7," \u{1F4CB} Liste des pollutions "),s(),a(8,"a",5),l(9," \u2795 Signaler une pollution "),s(),f(10,et,4,3,"a",6),a(11,"a",7),l(12," \u{1F510} Connexion "),s(),f(13,tt,5,1,"div",8),s()(),a(14,"main",9),re(15,"router-outlet"),s(),a(16,"footer",10)(17,"p"),l(18," \xA9 2025 Pollution Tracker - Application de signalement de pollutions "),s()()()),t&2&&(d(10),_(o.userName?10:-1),d(3),_(o.userName?13:-1))},dependencies:[j,ce,me,ue,Ie,se],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}.app-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;background-color:#f5f6fa}.navbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:.9375rem 1.875rem;display:flex;justify-content:space-between;align-items:center;box-shadow:0 .25rem .75rem #00000026}.navbar-brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0}.navbar-menu[_ngcontent-%COMP%]{display:flex;gap:1.25rem}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;padding:.625rem 1.25rem;border-radius:.375rem;font-weight:500;transition:all .3s;background:#ffffff1a}.nav-link[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-.125rem)}.nav-link.active[_ngcontent-%COMP%]{background:#ffffff4d;font-weight:700}.favorites-link[_ngcontent-%COMP%]{position:relative}.badge[_ngcontent-%COMP%]{position:absolute;top:-.375rem;right:-.375rem;background:#dc3545;color:#fff;border-radius:50%;padding:.15rem .5rem;font-size:.75rem;font-weight:700;min-width:1.25rem;text-align:center;box-shadow:0 .125rem .25rem #0003}.nav-user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;color:#fff}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;text-decoration:underline;font-size:.875rem}.btn-link[_ngcontent-%COMP%]:hover{color:#f0f0f0}.main-content[_ngcontent-%COMP%]{flex:1;padding:1.25rem;max-width:100%}.footer[_ngcontent-%COMP%]{background:#2c3e50;color:#fff;text-align:center;padding:1.25rem;margin-top:auto}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem}@media (max-width: 48rem){.navbar[_ngcontent-%COMP%]{flex-direction:column;gap:.9375rem;padding:.9375rem 1.25rem}.navbar-brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.navbar-menu[_ngcontent-%COMP%]{width:100%;flex-direction:column;gap:.625rem}.nav-link[_ngcontent-%COMP%]{text-align:center}.main-content[_ngcontent-%COMP%]{padding:.625rem}}"]});var A=C;te([Ce(W.getFavoritesCount)],A.prototype,"favoritesCount$",void 0);le(A,We).catch(e=>console.error(e));
